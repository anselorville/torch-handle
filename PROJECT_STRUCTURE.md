# é¡¹ç›®ç»“æ„è¯¦è§£

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº† `torch-handle` é¡¹ç›®çš„ç›®å½•ç»“æ„å’Œæ¨¡å—è®¾è®¡åŸåˆ™ã€‚

## ğŸ“‚ ç›®å½•ç»“æ„

```
torch-handle/
â”‚
â”œâ”€â”€ ğŸ“ model/                          # ã€Layer 1: åº•å±‚æ¨¡å‹ç»„ä»¶ã€‘
â”‚   â”œâ”€â”€ __init__.py                    # æ¨¡å—å¯¼å‡º
â”‚   â”œâ”€â”€ embeddings.py                  # è¯åµŒå…¥ + ä½ç½®ç¼–ç 
â”‚   â”œâ”€â”€ attention.py                   # å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶
â”‚   â”œâ”€â”€ layers.py                      # FFNã€æ®‹å·®è¿æ¥ã€LayerNorm
â”‚   â””â”€â”€ transformer.py                 # å®Œæ•´ Transformerï¼ˆEncoder + Decoderï¼‰
â”‚
â”œâ”€â”€ ğŸ“ data/                           # ã€Layer 2: æ•°æ®å¤„ç†å±‚ã€‘
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ dataset.py                     # è‡ªå®šä¹‰æ•°æ®é›†ï¼ˆTokenizationã€è¯æ±‡è¡¨ï¼‰
â”‚   â””â”€â”€ dataloader.py                  # åˆ†å¸ƒå¼æ•°æ®åŠ è½½å™¨ï¼ˆDistributedSamplerï¼‰
â”‚
â”œâ”€â”€ ğŸ“ train/                          # ã€Layer 3: è®­ç»ƒé€»è¾‘å±‚ã€‘
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ ddp_trainer.py                 # DDP è®­ç»ƒå™¨ï¼ˆå•æœº/å¤šèŠ‚ç‚¹ï¼‰
â”‚   â””â”€â”€ deepspeed_trainer.py           # DeepSpeed è®­ç»ƒå™¨ï¼ˆZeRO ä¼˜åŒ–ï¼‰
â”‚
â”œâ”€â”€ ğŸ“ utils/                          # ã€Layer 4: å·¥å…·ä¸ä¼˜åŒ–ã€‘
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ checkpoint.py                  # Checkpoint ä¿å­˜/åŠ è½½/ç®¡ç†
â”‚   â”œâ”€â”€ profiler.py                    # æ€§èƒ½åˆ†æå·¥å…·ï¼ˆPyTorch Profilerï¼‰
â”‚   â””â”€â”€ gradient_checkpointing.py      # æ¢¯åº¦æ£€æŸ¥ç‚¹è¾…åŠ©å‡½æ•°
â”‚
â”œâ”€â”€ ğŸ“ config/                         # ã€Layer 5: é…ç½®ç®¡ç†ã€‘
â”‚   â”œâ”€â”€ ds_config_stage1.json          # DeepSpeed Stage 1 é…ç½®
â”‚   â”œâ”€â”€ ds_config_stage2.json          # DeepSpeed Stage 2 é…ç½®
â”‚   â”œâ”€â”€ ds_config_stage3.json          # DeepSpeed Stage 3 é…ç½®ï¼ˆLLMï¼‰
â”‚   â””â”€â”€ model_config.yaml              # æ¨¡å‹è¶…å‚æ•°é…ç½®
â”‚
â”œâ”€â”€ ğŸ“ scripts/                        # ã€Layer 6: å¯åŠ¨è„šæœ¬ã€‘
â”‚   â”œâ”€â”€ train_ddp_single_node.sh       # å•æœºå¤šå¡ DDP è®­ç»ƒ
â”‚   â”œâ”€â”€ train_ddp_multi_node.sh        # å¤šèŠ‚ç‚¹ DDP è®­ç»ƒ
â”‚   â””â”€â”€ train_deepspeed.sh             # DeepSpeed è®­ç»ƒï¼ˆZeROï¼‰
â”‚
â”œâ”€â”€ main.py                            # ã€ä¸»å…¥å£ã€‘è®­ç»ƒæµç¨‹ç¼–æ’
â”œâ”€â”€ requirements.txt                   # ä¾èµ–ç®¡ç†
â”œâ”€â”€ README.md                          # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ PROJECT_STRUCTURE.md               # æœ¬æ–‡ä»¶
â””â”€â”€ .gitignore                         # Git å¿½ç•¥æ–‡ä»¶
```

---

## ğŸ”„ æ¨¡å—ä¾èµ–å…³ç³»

æœ¬é¡¹ç›®é‡‡ç”¨**è‡ªåº•å‘ä¸Š**çš„æ¨¡å—è®¾è®¡ï¼Œéµå¾ªä»¥ä¸‹ä¾èµ–åŸåˆ™ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Layer 6: ä¸»å…¥å£                          â”‚
â”‚                     main.py                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Layer 5: é…ç½®ç®¡ç†                                â”‚
â”‚         config/*.json, config/*.yaml                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Layer 4: å·¥å…·ä¸ä¼˜åŒ–                              â”‚
â”‚     utils/ (checkpoint, profiler, gradient_checkpointing)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Layer 3: è®­ç»ƒé€»è¾‘å±‚                              â”‚
â”‚          train/ (ddp_trainer, deepspeed_trainer)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Layer 2: æ•°æ®å¤„ç†å±‚    â”‚                                 â”‚
â”‚       data/ (dataset,      â”‚                                 â”‚
â”‚         dataloader)        â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
                                                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                   Layer 1: åº•å±‚æ¨¡å‹ç»„ä»¶                        â”‚
â”‚       model/ (embeddings, attention, layers, transformer)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¾èµ–è§„åˆ™

1. **ä¸Šå±‚ä¾èµ–ä¸‹å±‚**ï¼šæ¯ä¸€å±‚åªèƒ½ä¾èµ–æ¯”å®ƒæ›´åº•å±‚çš„æ¨¡å—
2. **åŒå±‚ç‹¬ç«‹**ï¼šåŒä¸€å±‚çš„æ¨¡å—ä¹‹é—´å°½é‡ä¿æŒç‹¬ç«‹
3. **æ¥å£æ¸…æ™°**ï¼šæ¯ä¸ªæ¨¡å—é€šè¿‡ `__init__.py` æ˜ç¡®å¯¼å‡ºçš„æ¥å£

---

## ğŸ“ å„å±‚è¯¦ç»†è¯´æ˜

### Layer 1: åº•å±‚æ¨¡å‹ç»„ä»¶ (`model/`)

**æ„å»ºé¡ºåº**ï¼š1 â†’ 2 â†’ 3 â†’ 4

| æ–‡ä»¶ | åŠŸèƒ½ | å…³é”®ç±»/å‡½æ•° |
|------|------|------------|
| `embeddings.py` | è¯åµŒå…¥å’Œä½ç½®ç¼–ç  | `PositionalEncoding`, `TransformerEmbedding` |
| `attention.py` | å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ | `ScaledDotProductAttention`, `MultiHeadAttention` |
| `layers.py` | Transformer å±‚ç»„ä»¶ | `PositionwiseFeedForward`, `TransformerBlock` |
| `transformer.py` | å®Œæ•´ Transformer æ¶æ„ | `Transformer`, `TransformerEncoder`, `TransformerDecoder` |

**ä¾èµ–å…³ç³»**ï¼š
- `transformer.py` ä¾èµ– `embeddings.py`, `attention.py`, `layers.py`
- `layers.py` ä¾èµ– `attention.py`
- `embeddings.py` å’Œ `attention.py` äº’ç›¸ç‹¬ç«‹

---

### Layer 2: æ•°æ®å¤„ç†å±‚ (`data/`)

**æ„å»ºé¡ºåº**ï¼š5 â†’ 6

| æ–‡ä»¶ | åŠŸèƒ½ | å…³é”®ç±»/å‡½æ•° |
|------|------|------------|
| `dataset.py` | è‡ªå®šä¹‰æ•°æ®é›† | `TranslationDataset`, `create_vocabulary`, `load_parallel_corpus` |
| `dataloader.py` | åˆ†å¸ƒå¼æ•°æ®åŠ è½½ | `create_distributed_dataloader`, `DataLoaderWrapper` |

**å…³é”®æŠ€æœ¯**ï¼š
- ä½¿ç”¨ `DistributedSampler` å®ç°æ•°æ®åˆ†ç‰‡
- å¿…é¡»åœ¨æ¯ä¸ª epoch è°ƒç”¨ `sampler.set_epoch(epoch)`

---

### Layer 3: è®­ç»ƒé€»è¾‘å±‚ (`train/`)

**æ„å»ºé¡ºåº**ï¼š7 â†’ 8

| æ–‡ä»¶ | åŠŸèƒ½ | å…³é”®ç±»/å‡½æ•° |
|------|------|------------|
| `ddp_trainer.py` | DDP è®­ç»ƒå™¨ | `DDPTrainer`, `ddp_setup`, `cleanup` |
| `deepspeed_trainer.py` | DeepSpeed è®­ç»ƒå™¨ | `DeepSpeedTrainer`, `get_deepspeed_config` |

**å…³é”®æŠ€æœ¯**ï¼š
- DDP: `DistributedDataParallel` å°è£…ï¼Œæ¢¯åº¦ Bucketingï¼Œé€šä¿¡/è®¡ç®—é‡å 
- DeepSpeed: ZeRO Stage 1/2/3ï¼Œæ··åˆç²¾åº¦ï¼Œå‚æ•°å¸è½½

---

### Layer 4: å·¥å…·ä¸ä¼˜åŒ– (`utils/`)

**æ„å»ºé¡ºåº**ï¼š9 â†’ 10 â†’ 11

| æ–‡ä»¶ | åŠŸèƒ½ | å…³é”®ç±»/å‡½æ•° |
|------|------|------------|
| `checkpoint.py` | Checkpoint ç®¡ç† | `save_checkpoint`, `load_checkpoint`, `get_latest_checkpoint` |
| `profiler.py` | æ€§èƒ½åˆ†æ | `ProfilerWrapper`, `analyze_communication_overlap` |
| `gradient_checkpointing.py` | æ¢¯åº¦æ£€æŸ¥ç‚¹ | `apply_gradient_checkpointing`, `checkpoint_sequential` |

---

### Layer 5: é…ç½®ç®¡ç† (`config/`)

**æ„å»ºé¡ºåº**ï¼š12

| æ–‡ä»¶ | åŠŸèƒ½ | é€‚ç”¨åœºæ™¯ |
|------|------|---------|
| `ds_config_stage1.json` | ZeRO Stage 1 é…ç½® | ä»…åˆ†ç‰‡ä¼˜åŒ–å™¨çŠ¶æ€ |
| `ds_config_stage2.json` | ZeRO Stage 2 é…ç½® | åˆ†ç‰‡ä¼˜åŒ–å™¨ + æ¢¯åº¦ï¼ˆæ¨èï¼‰ |
| `ds_config_stage3.json` | ZeRO Stage 3 é…ç½® | å…¨åˆ†ç‰‡ï¼ˆLLM è®­ç»ƒï¼‰ |
| `model_config.yaml` | æ¨¡å‹è¶…å‚æ•°é…ç½® | ç»Ÿä¸€ç®¡ç†æ¨¡å‹ã€è®­ç»ƒã€æ•°æ®é…ç½® |

---

### Layer 6: å¯åŠ¨è„šæœ¬ (`scripts/`)

**æ„å»ºé¡ºåº**ï¼š13

| æ–‡ä»¶ | åŠŸèƒ½ | ä½¿ç”¨åœºæ™¯ |
|------|------|---------|
| `train_ddp_single_node.sh` | å•æœºå¤šå¡è®­ç»ƒ | 8 å¼  GPUï¼Œæ ‡å‡† DDP |
| `train_ddp_multi_node.sh` | å¤šèŠ‚ç‚¹è®­ç»ƒ | 2+ èŠ‚ç‚¹ï¼Œéœ€åœ¨æ¯ä¸ªèŠ‚ç‚¹è¿è¡Œ |
| `train_deepspeed.sh` | DeepSpeed è®­ç»ƒ | ZeRO Stage 2ï¼Œå¯ç”¨æ¢¯åº¦æ£€æŸ¥ç‚¹ |

---

## ğŸ”§ ä½¿ç”¨å»ºè®®

### 1. å­¦ä¹ è·¯å¾„

**åˆå­¦è€…**ï¼š
1. é˜…è¯» `model/embeddings.py` å’Œ `model/attention.py`
2. è¿è¡Œå•å¡è®­ç»ƒï¼š`python main.py --mode single`

**è¿›é˜¶è€…**ï¼š
1. å­¦ä¹  `train/ddp_trainer.py`
2. è¿è¡Œå•æœºå¤šå¡è®­ç»ƒï¼š`bash scripts/train_ddp_single_node.sh`

**ä¸“å®¶**ï¼š
1. ç ”ç©¶ `train/deepspeed_trainer.py` å’Œ ZeRO é…ç½®
2. å¯ç”¨æ¢¯åº¦æ£€æŸ¥ç‚¹å¹¶åˆ†æå†…å­˜èŠ‚çœ
3. ä½¿ç”¨ Profiler ä¼˜åŒ–è®­ç»ƒæ€§èƒ½

### 2. æ‰©å±•å»ºè®®

**æ·»åŠ æ–°æ¨¡å‹**ï¼š
- åœ¨ `model/` ä¸­åˆ›å»ºæ–°æ–‡ä»¶ï¼Œç»§æ‰¿ `nn.Module`
- åœ¨ `model/__init__.py` ä¸­å¯¼å‡º

**æ·»åŠ æ–°æ•°æ®é›†**ï¼š
- åœ¨ `data/dataset.py` ä¸­æ·»åŠ æ–°çš„ `Dataset` ç±»
- æ›´æ–° `main.py` ä¸­çš„æ•°æ®é›†åŠ è½½é€»è¾‘

**æ·»åŠ æ–°ä¼˜åŒ–å™¨**ï¼š
- åœ¨ `train/` ä¸­åˆ›å»ºæ–°çš„ Trainer ç±»
- åœ¨ `main.py` ä¸­æ·»åŠ å¯¹åº”çš„è®­ç»ƒæ¨¡å¼

---

## ğŸ“Š å†…å­˜ä¸æ€§èƒ½ä¼˜åŒ–è·¯çº¿å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸºå‡†ï¼šDDP (Stage 0)                                         â”‚
â”‚  å†…å­˜: 1x, é€Ÿåº¦: 1x                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¼˜åŒ– 1: ZeRO Stage 1ï¼ˆåˆ†ç‰‡ä¼˜åŒ–å™¨çŠ¶æ€ï¼‰                       â”‚
â”‚  å†…å­˜: ~1.5x, é€Ÿåº¦: 0.95x                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¼˜åŒ– 2: ZeRO Stage 2ï¼ˆåˆ†ç‰‡ä¼˜åŒ–å™¨ + æ¢¯åº¦ï¼‰                    â”‚
â”‚  å†…å­˜: ~3-4x, é€Ÿåº¦: 0.85x                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¼˜åŒ– 3: ZeRO Stage 3ï¼ˆå…¨åˆ†ç‰‡ï¼‰                               â”‚
â”‚  å†…å­˜: >10x, é€Ÿåº¦: 0.7x                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¼˜åŒ– 4: Stage 3 + æ¢¯åº¦æ£€æŸ¥ç‚¹                                 â”‚
â”‚  å†…å­˜: >20x, é€Ÿåº¦: 0.5x                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¼˜åŒ– 5: Stage 3 + GC + CPU/NVMe å¸è½½                        â”‚
â”‚  å†…å­˜: >50x, é€Ÿåº¦: 0.3x                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ å‚è€ƒæ–‡çŒ®

- PyTorch DDP: https://docs.pytorch.org/tutorials/intermediate/ddp_tutorial.html
- DeepSpeed ZeRO: https://www.deepspeed.ai/tutorials/zero/
- Transformer è®ºæ–‡: *Attention Is All You Need* (Vaswani et al., 2017)

---

**æœ€åæ›´æ–°**: 2025-10-18

